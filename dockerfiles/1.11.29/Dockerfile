# This file is automatically generated with Dockerfile.j2 as a template. Do not
# edit by hand, since your changes will be lost!
FROM buildpack-deps AS builder

# Create a shallow clone of the implementation repository in the work directory,
# containing only the code of the specified version/tag.
WORKDIR /botan
RUN git clone --branch 1.11.29 --depth 1 https://github.com/randombit/botan.git .

# Botan version 1.11.25 to 1.11.29 are missing a <cmath> include, which causes
# the compilation to fail. This is fixed in a later version. By applying the
# fix to these earlier releases, the issue is resolved and Botan can be
# compiled.
RUN curl https://github.com/randombit/botan/commit/585a9056166c32d1d6537c163b8960b2106e3e21.patch | git apply -

# Build
RUN ./configure.py
RUN make